@startuml

entity "User" as user {
  *user_id : int <<PK>>
  --
  username : varchar
  password : varchar
  email : varchar
  profile_picture : varchar
}

entity "Admin" as admin {
  *admin_id : int <<PK>>
  --
  username : varchar
  password : varchar
}

entity "Transaksi" as transaksi {
  *transaksi_id : int <<PK>>
  user_id : int <<FK>>
  --
  total_amount : decimal
  total_quantity : int
  status : varchar
  created_at : datetime
  updated_at : datetime
}

entity "Detail_Transaksi" as detail_transaksi {
  *detail_id : int <<PK>>
  transaksi_id : int <<FK>>
  version_id : int <<FK>>
  --
  qty : int
  total : decimal
}

entity "Admin_Log" as admin_log {
  *log_id : int <<PK>>
  admin_id : int <<FK>>
  --
  action : varchar
  timestamp : datetime
}

entity "Produk" as produk {
  *produk_id : int <<PK>>
  --
  nama_produk : varchar
  brand_id : int <<FK>>
  kategori_id : int <<FK>>
}

entity "Produk_Version" as produk_version {
  *version_id : int <<PK>>
  produk_id : int <<FK>>
  previous_version_id : int <<FK, nullable>>
  --
  size : varchar
  warna : varchar
  description : text
  harga : decimal
  stok : int
  active_from : datetime
  active_to : datetime <<nullable>>
}

entity "Kategori" as kategori {
  *kategori_id : int <<PK>>
  --
  nama_kategori : varchar
}

entity "Brand" as brand {
  *brand_id : int <<PK>>
  --
  nama_brand : varchar
}

entity "Alamat" as alamat {
  *alamat_id : int <<PK>>
  user_id : int <<FK>>
  --
  alamat_lengkap : text
  kel : int
  kec : int
  kab : int
  prov : int
  kode_pos : varchar
}

entity "Cart" as cart {
  *cart_id : int <<PK>>
  user_id : int <<FK>>
  created_at : datetime
}

entity "Cart_Detail" as cart_detail {
  *cart_id : int <<FK>>
  *version_id : int <<FK>>
  jumlah : int
}

entity "Wishlist" as wishlist {
  *wishlist_id : int <<PK>>
  user_id : int <<FK>>
  version_id : int <<FK>>
  created_at : datetime
}

' =========================
' Relasi
' =========================
user ||--o{ alamat             : has
produk }o--|| kategori
produk }o--|| brand
admin_log }o--|| admin
cart }o--|| user
cart_detail }o--|| cart
cart_detail }o--|| produk_version
wishlist }o--|| user
wishlist }o--|| produk_version
transaksi }o--|| user
detail_transaksi }o--|| transaksi
detail_transaksi }o--|| produk_version
produk ||--o{ produk_version
produk_version }o--|| produk
produk_version }o--|| produk_version : previous

@enduml
